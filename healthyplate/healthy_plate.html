<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthy Plate Game</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; }
    </style>
</head>
<body>
    <div id="game-container"></div>

    <script>
        const config = {
            type: Phaser.AUTO,
            parent: 'game-container',
            width: 800,
            height: 600,
            backgroundColor: '#1a5276',
            physics: {
                default: 'arcade',
                arcade: { gravity: { y: 150 } }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            },
            scale: {
                mode: Phaser.Scale.FIT,
                autoCenter: Phaser.Scale.CENTER_BOTH
            }
        };

        const game = new Phaser.Game(config);
        let plate, foods, score = 0, scoreText;

        function preload() {
            this.load.image('plate', 'plate.png');
            this.load.image('broccoli', 'broccoli.png');
            this.load.image('apple', 'apple.png');
            this.load.image('carrot', 'carrot.png');
            this.load.image('donut', 'donut.png');
            this.load.image('soda', 'soda.png');
            this.load.image('burger', 'burger.png');
        }

        function create() {
            // Create plate (rectangle with rounded edges)
            plate = this.add.rectangle(400, 550, 150, 30, 0xffffff, 1)
                .setStrokeStyle(2, 0x000000)
                .setOrigin(0.5);
            this.physics.add.existing(plate);
            plate.body.setImmovable(true).setCollideWorldBounds(true);

            // Food group
            foods = this.physics.add.group();

            // Controls
            this.input.on('pointermove', (pointer) => {
                plate.x = Phaser.Math.Clamp(pointer.x, 75, 725);
            });

            // Score display
            scoreText = this.add.text(20, 20, 'Score: 0', {
                fontSize: '32px',
                fill: '#ffffff',
                fontStyle: 'bold',
                stroke: '#000000',
                strokeThickness: 4
            });

            // Spawn food every second
            this.time.addEvent({
                delay: 1000,
                callback: spawnFood,
                callbackScope: this,
                loop: true
            });

            // Collision handling
            this.physics.add.collider(plate, foods, (plate, food) => {
                if (['broccoli', 'apple', 'carrot'].includes(food.texture.key)) {
                    score += 10;
                } else {
                    score = Math.max(0, score - 5);
                }
                scoreText.setText(`Score: ${score}`);
                food.destroy();
            });
        }

        function update() {
            // Keyboard controls (optional)
            if (this.input.keyboard.addKey('LEFT').isDown) {
                plate.x = Phaser.Math.Clamp(plate.x - 10, 75, 725);
            } else if (this.input.keyboard.addKey('RIGHT').isDown) {
                plate.x = Phaser.Math.Clamp(plate.x + 10, 75, 725);
            }
        }

        function spawnFood() {
            const x = Phaser.Math.Between(100, 700);
            const isHealthy = Math.random() > 0.4;
            const foodType = isHealthy ? 
                Phaser.Math.RND.pick(['broccoli', 'apple', 'carrot']) : 
                Phaser.Math.RND.pick(['donut', 'soda', 'burger']);

            const food = foods.create(x, -50, foodType)
                .setScale(0.7)
                .setVelocity(Phaser.Math.Between(-50, 50), 0);
            
            // Remove food if it falls off screen
            food.setCollideWorldBounds(false);
            food.body.onWorldBounds = true;
            food.body.world.on('worldbounds', (body) => {
                if (body.gameObject === food) food.destroy();
            });
        }
    </script>
</body>
</html>